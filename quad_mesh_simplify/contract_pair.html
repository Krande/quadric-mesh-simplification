<!DOCTYPE html>
<!-- Generated by Cython 3.0a3 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: contract_pair.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.0a3</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="contract_pair.c">contract_pair.c</a></p>
<div class="cython"><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class='cython code score-13 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    {
      #if CYTHON_COMPILING_IN_LIMITED_API
      PyObject *__pyx_d = <span class='py_c_api'>PyModule_GetDict</span>(__pyx_m);<span class='error_goto'> if (unlikely(!__pyx_d)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
      #endif
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: <span class="k">from</span> <span class="nn">.targets</span> <span class="k">cimport</span> <span class="n">calculate_pair_attributes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">005</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">target_offset</span> <span class="o">=</span> <span class="mf">3</span></pre>
<pre class='cython code score-0 '>    __pyx_v_18quad_mesh_simplify_13contract_pair_target_offset = 3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">006</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">feature_offset</span> <span class="o">=</span> <span class="mf">3</span> <span class="o">+</span> <span class="mf">3</span></pre>
<pre class='cython code score-0 '>    __pyx_v_18quad_mesh_simplify_13contract_pair_feature_offset = 6;
</pre><pre class="cython line score-0">&#xA0;<span class="">007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span> <span class="c"># turn off bounds-checking for entire function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>  <span class="c"># turn off negative index wrapping for entire function</span></pre>
<pre class="cython line score-150" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">010</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">update_pairs</span><span class="p">(</span></pre>
<pre class='cython code score-150 '>static PyObject *__pyx_pw_18quad_mesh_simplify_13contract_pair_1update_pairs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static void __pyx_f_18quad_mesh_simplify_13contract_pair_update_pairs(long __pyx_v_v1, long __pyx_v_v2, struct __pyx_obj_18quad_mesh_simplify_4heap_PairHeap *__pyx_v_heap, __Pyx_memviewslice __pyx_v_positions, __Pyx_memviewslice __pyx_v_Q, __Pyx_memviewslice __pyx_v_features, CYTHON_UNUSED int __pyx_skip_dispatch) {
  long __pyx_v_i;
  __Pyx_memviewslice __pyx_v_pair = { 0, 0, { 0 }, { 0 }, { 0 } };
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_pairs", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_4, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("quad_mesh_simplify.contract_pair.update_pairs", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pair, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_18quad_mesh_simplify_13contract_pair_1update_pairs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_18quad_mesh_simplify_13contract_pair_update_pairs, "updates all pairs by calculating all errors according to the contracted edge and removes the contracted\n    pair from the pairs array.\n\n    Args:\n        pairs (:class:`ndarray`): list of pairs\n        positions (:class:`ndarray`): array of shape num_nodes x 3 containing the x, y, z position for each node\n        Q (:class:`ndarray`): array of shape num_faces x 3 containing the indices for each triangular face\n        features (:class:`ndarray`, optional): array of shape num_nodes x num_features\n\n    :rtype: :class:`ndarray`\n    ");
static PyMethodDef __pyx_mdef_18quad_mesh_simplify_13contract_pair_1update_pairs = {"update_pairs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_18quad_mesh_simplify_13contract_pair_1update_pairs, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_18quad_mesh_simplify_13contract_pair_update_pairs};
static PyObject *__pyx_pw_18quad_mesh_simplify_13contract_pair_1update_pairs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  long __pyx_v_v1;
  long __pyx_v_v2;
  struct __pyx_obj_18quad_mesh_simplify_4heap_PairHeap *__pyx_v_heap = 0;
  __Pyx_memviewslice __pyx_v_positions = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_Q = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_features = { 0, 0, { 0 }, { 0 }, { 0 } };
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_pairs (wrapper)", 0);
  {
    #if CYTHON_COMPILING_IN_LIMITED_API
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v1,&amp;__pyx_n_s_v2,&amp;__pyx_n_s_heap,&amp;__pyx_n_s_positions,&amp;__pyx_n_s_Q,&amp;__pyx_n_s_features,0};
    #else
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v1,&amp;__pyx_n_s_v2,&amp;__pyx_n_s_heap,&amp;__pyx_n_s_positions,&amp;__pyx_n_s_Q,&amp;__pyx_n_s_features,0};
    #endif
    PyObject* values[6] = {0,0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v1)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v2)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_pairs", 1, 6, 6, 1); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_heap)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_pairs", 1, 6, 6, 2); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_positions)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_pairs", 1, 6, 6, 3); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_Q)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_pairs", 1, 6, 6, 4); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_features)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_pairs", 1, 6, 6, 5); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "update_pairs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 6)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
      values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
      values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
    }
    __pyx_v_v1 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_v1 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 11, __pyx_L3_error)</span>
    __pyx_v_v2 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_v2 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L3_error)</span>
    __pyx_v_heap = ((struct __pyx_obj_18quad_mesh_simplify_4heap_PairHeap *)values[2]);
    __pyx_v_positions = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_positions.memview)) __PYX_ERR(0, 14, __pyx_L3_error)</span>
    __pyx_v_Q = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsdsds_double</span>(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_Q.memview)) __PYX_ERR(0, 15, __pyx_L3_error)</span>
    __pyx_v_features = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_features.memview)) __PYX_ERR(0, 16, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_pairs", 1, 6, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("quad_mesh_simplify.contract_pair.update_pairs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_heap), __pyx_ptype_18quad_mesh_simplify_4heap_PairHeap, 1, "heap", 0))) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_18quad_mesh_simplify_13contract_pair_update_pairs(__pyx_self, __pyx_v_v1, __pyx_v_v2, __pyx_v_heap, __pyx_v_positions, __pyx_v_Q, __pyx_v_features);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_18quad_mesh_simplify_13contract_pair_update_pairs(CYTHON_UNUSED PyObject *__pyx_self, long __pyx_v_v1, long __pyx_v_v2, struct __pyx_obj_18quad_mesh_simplify_4heap_PairHeap *__pyx_v_heap, __Pyx_memviewslice __pyx_v_positions, __Pyx_memviewslice __pyx_v_Q, __Pyx_memviewslice __pyx_v_features) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_pairs", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_positions.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("positions"); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_Q.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("Q"); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_features.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("features"); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_18quad_mesh_simplify_13contract_pair_update_pairs(__pyx_v_v1, __pyx_v_v2, __pyx_v_heap, __pyx_v_positions, __pyx_v_Q, __pyx_v_features, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("quad_mesh_simplify.contract_pair.update_pairs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_positions, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_Q, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_features, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_v1, __pyx_n_s_v2, __pyx_n_s_heap, __pyx_n_s_positions, __pyx_n_s_Q, __pyx_n_s_features);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
/* … */
    #if CYTHON_COMPILING_IN_LIMITED_API
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_18quad_mesh_simplify_13contract_pair_1update_pairs, 0, __pyx_n_s_update_pairs, NULL, __pyx_n_s_quad_mesh_simplify_contract_pair_2, __pyx_t_2, ((PyObject *)__pyx_codeobj__28));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    #else
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_18quad_mesh_simplify_13contract_pair_1update_pairs, 0, __pyx_n_s_update_pairs, NULL, __pyx_n_s_quad_mesh_simplify_contract_pair_2, __pyx_d, ((PyObject *)__pyx_codeobj__28));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
    #endif
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    {
      #if CYTHON_COMPILING_IN_LIMITED_API
      PyObject *__pyx_d = <span class='py_c_api'>PyModule_GetDict</span>(__pyx_m);<span class='error_goto'> if (unlikely(!__pyx_d)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
      #endif
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_update_pairs, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
  __pyx_codeobj__28 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_quad_mesh_simplify_contract_pair, __pyx_n_s_update_pairs, 10, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">011</span>:     <span class="nb">long</span> <span class="n">v1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>:     <span class="nb">long</span> <span class="n">v2</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>:     <span class="n">PairHeap</span> <span class="n">heap</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>:     <span class="n">double</span> <span class="p">[:,</span> <span class="p">:]</span> <span class="n">positions</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>:     <span class="n">double</span> <span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="n">Q</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>:     <span class="n">double</span> <span class="p">[:,</span> <span class="p">:]</span> <span class="n">features</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>:     <span class="sd">&quot;&quot;&quot;updates all pairs by calculating all errors according to the contracted edge and removes the contracted</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>: <span class="sd">    pair from the pairs array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: <span class="sd">    Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: <span class="sd">        pairs (:class:`ndarray`): list of pairs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: <span class="sd">        positions (:class:`ndarray`): array of shape num_nodes x 3 containing the x, y, z position for each node</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: <span class="sd">        Q (:class:`ndarray`): array of shape num_faces x 3 containing the indices for each triangular face</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: <span class="sd">        features (:class:`ndarray`, optional): array of shape num_nodes x num_features</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: <span class="sd">    :rtype: :class:`ndarray`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">i</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">pair</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>:     <span class="c"># iterate over all pairs and recalculate error if needed</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">heap</span><span class="o">.</span><span class="n">length</span><span class="p">()):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((struct __pyx_vtabstruct_18quad_mesh_simplify_4heap_PairHeap *)__pyx_v_heap-&gt;__pyx_vtab)-&gt;length(__pyx_v_heap, 0);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>:         <span class="n">pair</span> <span class="o">=</span> <span class="n">heap</span><span class="o">.</span><span class="n">get_pair</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = ((struct __pyx_vtabstruct_18quad_mesh_simplify_4heap_PairHeap *)__pyx_v_heap-&gt;__pyx_vtab)-&gt;get_pair(__pyx_v_heap, __pyx_v_i, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pair, 1);
    __pyx_v_pair = __pyx_t_4;
    __pyx_t_4.memview = NULL;
    __pyx_t_4.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">034</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">v1</span> <span class="ow">or</span> <span class="n">pair</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">v1</span><span class="p">)</span> <span class="ow">and</span> \</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = 1;
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_6 * __pyx_v_pair.strides[0]) ))) == __pyx_v_v1) != 0);
    if (!__pyx_t_7) {
    } else {
      goto __pyx_L7_next_and;
    }
    __pyx_t_6 = 2;
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_6 * __pyx_v_pair.strides[0]) ))) == __pyx_v_v1) != 0);
    if (__pyx_t_7) {
    } else {
      __pyx_t_5 = __pyx_t_7;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_L7_next_and:;
/* … */
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>:             <span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">v2</span> <span class="ow">or</span> <span class="n">pair</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">v2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = 1;
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_6 * __pyx_v_pair.strides[0]) ))) == __pyx_v_v2) != 0);
    if (!__pyx_t_7) {
    } else {
      __pyx_t_5 = __pyx_t_7;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_6 = 2;
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_6 * __pyx_v_pair.strides[0]) ))) == __pyx_v_v2) != 0);
    __pyx_t_5 = __pyx_t_7;
    __pyx_L6_bool_binop_done:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:             <span class="n">pair</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10e6</span> <span class="c"># low value so pair will appear first and gets unvalid in simplify.pyx</span></pre>
<pre class='cython code score-0 '>      __pyx_t_6 = 0;
      *((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_6 * __pyx_v_pair.strides[0]) )) = -10e6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">038</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">039</span>:         <span class="k">if</span> <span class="n">pair</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">v1</span> <span class="ow">or</span> <span class="n">pair</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">v2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = 1;
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_8 * __pyx_v_pair.strides[0]) ))) == __pyx_v_v1) != 0);
    if (!__pyx_t_7) {
    } else {
      __pyx_t_5 = __pyx_t_7;
      goto __pyx_L11_bool_binop_done;
    }
    __pyx_t_8 = 1;
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_8 * __pyx_v_pair.strides[0]) ))) == __pyx_v_v2) != 0);
    __pyx_t_5 = __pyx_t_7;
    __pyx_L11_bool_binop_done:;
    if (__pyx_t_5) {
/* … */
      goto __pyx_L10;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">040</span>:             <span class="n">calculate_pair_attributes</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>      __pyx_f_18quad_mesh_simplify_7targets_calculate_pair_attributes(__pyx_v_v1, ((long)(*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_8 * __pyx_v_pair.strides[0]) )))), __pyx_v_positions, __pyx_v_Q, __pyx_v_features, __pyx_v_pair, 0);
</pre><pre class="cython line score-0">&#xA0;<span class="">041</span>:                 <span class="n">v1</span><span class="p">,</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>:                 <span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;</span><span class="n">pair</span><span class="p">[</span><span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = 2;
</pre><pre class="cython line score-0">&#xA0;<span class="">043</span>:                 <span class="n">positions</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>:                 <span class="n">Q</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>:                 <span class="n">features</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>:                 <span class="n">pair</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>:         <span class="k">elif</span> <span class="n">pair</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">v1</span> <span class="ow">or</span> <span class="n">pair</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">v2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = 2;
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_8 * __pyx_v_pair.strides[0]) ))) == __pyx_v_v1) != 0);
    if (!__pyx_t_7) {
    } else {
      __pyx_t_5 = __pyx_t_7;
      goto __pyx_L13_bool_binop_done;
    }
    __pyx_t_8 = 2;
    __pyx_t_7 = (((*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_8 * __pyx_v_pair.strides[0]) ))) == __pyx_v_v2) != 0);
    __pyx_t_5 = __pyx_t_7;
    __pyx_L13_bool_binop_done:;
    if (__pyx_t_5) {
/* … */
    }
    __pyx_L10:;
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:             <span class="n">calculate_pair_attributes</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>      __pyx_f_18quad_mesh_simplify_7targets_calculate_pair_attributes(((long)(*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_8 * __pyx_v_pair.strides[0]) )))), __pyx_v_v1, __pyx_v_positions, __pyx_v_Q, __pyx_v_features, __pyx_v_pair, 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>:                 <span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;</span><span class="n">pair</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">051</span>:                 <span class="n">v1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>:                 <span class="n">positions</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>:                 <span class="n">Q</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>:                 <span class="n">features</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>:                 <span class="n">pair</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>:     <span class="n">heap</span><span class="o">.</span><span class="n">build</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_18quad_mesh_simplify_4heap_PairHeap *)__pyx_v_heap-&gt;__pyx_vtab)-&gt;build(__pyx_v_heap);
</pre><pre class="cython line score-0">&#xA0;<span class="">058</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span> <span class="c"># turn off bounds-checking for entire function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>  <span class="c"># turn off negative index wrapping for entire function</span></pre>
<pre class="cython line score-116" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">update_face</span><span class="p">(</span></pre>
<pre class='cython code score-116 '>static PyObject *__pyx_pw_18quad_mesh_simplify_13contract_pair_3update_face(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static void __pyx_f_18quad_mesh_simplify_13contract_pair_update_face(long __pyx_v_v1, long __pyx_v_v2, __Pyx_memviewslice __pyx_v_face, __Pyx_memviewslice __pyx_v_deleted_faces, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_v1_in_face;
  int __pyx_v_v2_in_face;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_face", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_18quad_mesh_simplify_13contract_pair_3update_face(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_18quad_mesh_simplify_13contract_pair_2update_face, "updates a face for a contracted pair by removing all faces accordingly.\n\n    Args:\n        pair (:class:`ndarray`): pair that should be contracted\n        face (:class:`ndarray`): face array that will be updated\n\n    :rtype: :class:`ndarray`\n    ");
static PyMethodDef __pyx_mdef_18quad_mesh_simplify_13contract_pair_3update_face = {"update_face", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_18quad_mesh_simplify_13contract_pair_3update_face, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_18quad_mesh_simplify_13contract_pair_2update_face};
static PyObject *__pyx_pw_18quad_mesh_simplify_13contract_pair_3update_face(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  long __pyx_v_v1;
  long __pyx_v_v2;
  __Pyx_memviewslice __pyx_v_face = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_deleted_faces = { 0, 0, { 0 }, { 0 }, { 0 } };
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_face (wrapper)", 0);
  {
    #if CYTHON_COMPILING_IN_LIMITED_API
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v1,&amp;__pyx_n_s_v2,&amp;__pyx_n_s_face,&amp;__pyx_n_s_deleted_faces,0};
    #else
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_v1,&amp;__pyx_n_s_v2,&amp;__pyx_n_s_face,&amp;__pyx_n_s_deleted_faces,0};
    #endif
    PyObject* values[4] = {0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v1)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v2)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_face", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_face)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_face", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deleted_faces)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_face", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "update_face") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
    }
    __pyx_v_v1 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[0]); if (unlikely((__pyx_v_v1 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 62, __pyx_L3_error)</span>
    __pyx_v_v2 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(values[1]); if (unlikely((__pyx_v_v2 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 63, __pyx_L3_error)</span>
    __pyx_v_face = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_long</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_face.memview)) __PYX_ERR(0, 64, __pyx_L3_error)</span>
    __pyx_v_deleted_faces = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_char</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_deleted_faces.memview)) __PYX_ERR(0, 65, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_face", 1, 4, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("quad_mesh_simplify.contract_pair.update_face", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_18quad_mesh_simplify_13contract_pair_2update_face(__pyx_self, __pyx_v_v1, __pyx_v_v2, __pyx_v_face, __pyx_v_deleted_faces);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_18quad_mesh_simplify_13contract_pair_2update_face(CYTHON_UNUSED PyObject *__pyx_self, long __pyx_v_v1, long __pyx_v_v2, __Pyx_memviewslice __pyx_v_face, __Pyx_memviewslice __pyx_v_deleted_faces) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_face", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_face.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("face"); <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_deleted_faces.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("deleted_faces"); <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_18quad_mesh_simplify_13contract_pair_update_face(__pyx_v_v1, __pyx_v_v2, __pyx_v_face, __pyx_v_deleted_faces, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("quad_mesh_simplify.contract_pair.update_face", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_face, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_deleted_faces, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_v1, __pyx_n_s_v2, __pyx_n_s_face, __pyx_n_s_deleted_faces);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
/* … */
    #if CYTHON_COMPILING_IN_LIMITED_API
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_18quad_mesh_simplify_13contract_pair_3update_face, 0, __pyx_n_s_update_face, NULL, __pyx_n_s_quad_mesh_simplify_contract_pair_2, __pyx_t_2, ((PyObject *)__pyx_codeobj__30));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    #else
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_18quad_mesh_simplify_13contract_pair_3update_face, 0, __pyx_n_s_update_face, NULL, __pyx_n_s_quad_mesh_simplify_contract_pair_2, __pyx_d, ((PyObject *)__pyx_codeobj__30));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
    #endif
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    {
      #if CYTHON_COMPILING_IN_LIMITED_API
      PyObject *__pyx_d = <span class='py_c_api'>PyModule_GetDict</span>(__pyx_m);<span class='error_goto'> if (unlikely(!__pyx_d)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
      #endif
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_update_face, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
  __pyx_codeobj__30 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_quad_mesh_simplify_contract_pair, __pyx_n_s_update_face, 61, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">062</span>:     <span class="nb">long</span> <span class="n">v1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>:     <span class="nb">long</span> <span class="n">v2</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>:     <span class="nb">long</span> <span class="p">[:,</span> <span class="p">:]</span> <span class="n">face</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>:     <span class="n">char</span> <span class="p">[:]</span> <span class="n">deleted_faces</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>:     <span class="sd">&quot;&quot;&quot;updates a face for a contracted pair by removing all faces accordingly.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>: <span class="sd">    Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>: <span class="sd">        pair (:class:`ndarray`): pair that should be contracted</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>: <span class="sd">        face (:class:`ndarray`): face array that will be updated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>: <span class="sd">    :rtype: :class:`ndarray`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">v1_in_face</span><span class="p">,</span> <span class="nf">v2_in_face</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">076</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_face.shape[0]);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>:         <span class="k">if</span> <span class="n">deleted_faces</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = ((*((char *) ( /* dim=0 */ (__pyx_v_deleted_faces.data + __pyx_t_4 * __pyx_v_deleted_faces.strides[0]) ))) != 0);
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">079</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">080</span>:         <span class="n">v1_in_face</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_v_v1_in_face = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:         <span class="n">v2_in_face</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>    __pyx_v_v2_in_face = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">082</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    for (__pyx_t_6 = 0; __pyx_t_6 &lt; 3; __pyx_t_6+=1) {
      __pyx_v_j = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">084</span>:             <span class="k">if</span> <span class="n">v1</span> <span class="o">==</span> <span class="n">face</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_4 = __pyx_v_i;
      __pyx_t_7 = __pyx_v_j;
      __pyx_t_5 = ((__pyx_v_v1 == (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_face.data + __pyx_t_4 * __pyx_v_face.strides[0]) ) + __pyx_t_7 * __pyx_v_face.strides[1]) )))) != 0);
      if (__pyx_t_5) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>:                 <span class="n">v1_in_face</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>        __pyx_v_v1_in_face = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:             <span class="k">if</span> <span class="n">v2</span> <span class="o">==</span> <span class="n">face</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_i;
      __pyx_t_4 = __pyx_v_j;
      __pyx_t_5 = ((__pyx_v_v2 == (*((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_face.data + __pyx_t_7 * __pyx_v_face.strides[0]) ) + __pyx_t_4 * __pyx_v_face.strides[1]) )))) != 0);
      if (__pyx_t_5) {
/* … */
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:                 <span class="n">v2_in_face</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>        __pyx_v_v2_in_face = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">088</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>:                 <span class="c"># 2. point faces to new merged node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">090</span>:                 <span class="n">face</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">v1</span></pre>
<pre class='cython code score-0 '>        __pyx_t_4 = __pyx_v_i;
        __pyx_t_7 = __pyx_v_j;
        *((long *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_face.data + __pyx_t_4 * __pyx_v_face.strides[0]) ) + __pyx_t_7 * __pyx_v_face.strides[1]) )) = __pyx_v_v1;
</pre><pre class="cython line score-0">&#xA0;<span class="">091</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>:         <span class="c"># 1. remove faces with both nodes of pair</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">093</span>:         <span class="k">if</span> <span class="n">v1_in_face</span> <span class="ow">and</span> <span class="n">v2_in_face</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = (__pyx_v_v1_in_face != 0);
    if (__pyx_t_8) {
    } else {
      __pyx_t_5 = __pyx_t_8;
      goto __pyx_L11_bool_binop_done;
    }
    __pyx_t_8 = (__pyx_v_v2_in_face != 0);
    __pyx_t_5 = __pyx_t_8;
    __pyx_L11_bool_binop_done:;
    if (__pyx_t_5) {
/* … */
    }
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>:             <span class="n">deleted_faces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = __pyx_v_i;
      *((char *) ( /* dim=0 */ (__pyx_v_deleted_faces.data + __pyx_t_9 * __pyx_v_deleted_faces.strides[0]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">095</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span> <span class="c"># turn off bounds-checking for entire function</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>  <span class="c"># turn off negative index wrapping for entire function</span></pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>: <span class="k">cpdef</span> <span class="kt">void</span> <span class="nf">update_features</span><span class="p">(</span></pre>
<pre class='cython code score-78 '>static PyObject *__pyx_pw_18quad_mesh_simplify_13contract_pair_5update_features(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static void __pyx_f_18quad_mesh_simplify_13contract_pair_update_features(__Pyx_memviewslice __pyx_v_pair, __Pyx_memviewslice __pyx_v_features, CYTHON_UNUSED int __pyx_skip_dispatch) {
  long __pyx_v_v1;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_features", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("quad_mesh_simplify.contract_pair.update_features", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_18quad_mesh_simplify_13contract_pair_5update_features(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_18quad_mesh_simplify_13contract_pair_4update_features, "updates all features by contracting the given pair. In detail, it sets the features for the first node to\n    the feature vector of the contracted pair and removes the features of the second node.\n\n    Args:\n        pair (:class:`ndarray`): pair that should be contracted\n        features (:class:`ndarray`): features array that will be updated\n\n    :rtype: :class:`ndarray`\n    ");
static PyMethodDef __pyx_mdef_18quad_mesh_simplify_13contract_pair_5update_features = {"update_features", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_18quad_mesh_simplify_13contract_pair_5update_features, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_18quad_mesh_simplify_13contract_pair_4update_features};
static PyObject *__pyx_pw_18quad_mesh_simplify_13contract_pair_5update_features(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  __Pyx_memviewslice __pyx_v_pair = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_features = { 0, 0, { 0 }, { 0 }, { 0 } };
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_features (wrapper)", 0);
  {
    #if CYTHON_COMPILING_IN_LIMITED_API
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pair,&amp;__pyx_n_s_features,0};
    #else
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_pair,&amp;__pyx_n_s_features,0};
    #endif
    PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_pair)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_features)) != 0)) kw_args--;
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_features", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "update_features") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_pair = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_pair.memview)) __PYX_ERR(0, 100, __pyx_L3_error)</span>
    __pyx_v_features = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_features.memview)) __PYX_ERR(0, 101, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_features", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("quad_mesh_simplify.contract_pair.update_features", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_18quad_mesh_simplify_13contract_pair_4update_features(__pyx_self, __pyx_v_pair, __pyx_v_features);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_18quad_mesh_simplify_13contract_pair_4update_features(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_pair, __Pyx_memviewslice __pyx_v_features) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_features", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_pair.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("pair"); <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_features.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("features"); <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_18quad_mesh_simplify_13contract_pair_update_features(__pyx_v_pair, __pyx_v_features, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("quad_mesh_simplify.contract_pair.update_features", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pair, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_features, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_pair, __pyx_n_s_features);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
/* … */
    #if CYTHON_COMPILING_IN_LIMITED_API
    __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_18quad_mesh_simplify_13contract_pair_5update_features, 0, __pyx_n_s_update_features, NULL, __pyx_n_s_quad_mesh_simplify_contract_pair_2, __pyx_t_2, ((PyObject *)__pyx_codeobj__32));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    #else
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_18quad_mesh_simplify_13contract_pair_5update_features, 0, __pyx_n_s_update_features, NULL, __pyx_n_s_quad_mesh_simplify_contract_pair_2, __pyx_d, ((PyObject *)__pyx_codeobj__32));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
    #endif
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    {
      #if CYTHON_COMPILING_IN_LIMITED_API
      PyObject *__pyx_d = <span class='py_c_api'>PyModule_GetDict</span>(__pyx_m);<span class='error_goto'> if (unlikely(!__pyx_d)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
      #endif
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_update_features, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
  __pyx_codeobj__32 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_quad_mesh_simplify_contract_pair, __pyx_n_s_update_features, 99, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">100</span>:     <span class="n">double</span> <span class="p">[:]</span> <span class="n">pair</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>:     <span class="n">double</span> <span class="p">[:,</span> <span class="p">:]</span> <span class="n">features</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>:     <span class="sd">&quot;&quot;&quot;updates all features by contracting the given pair. In detail, it sets the features for the first node to</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>: <span class="sd">    the feature vector of the contracted pair and removes the features of the second node.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>: <span class="sd">    Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>: <span class="sd">        pair (:class:`ndarray`): pair that should be contracted</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>: <span class="sd">        features (:class:`ndarray`): features array that will be updated</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>: <span class="sd">    :rtype: :class:`ndarray`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">v1</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:     <span class="n">v1</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;</span><span class="n">pair</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 1;
  __pyx_v_v1 = ((long)(*((double *) ( /* dim=0 */ (__pyx_v_pair.data + __pyx_t_1 * __pyx_v_pair.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">113</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:     <span class="k">if</span> <span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (((__pyx_v_features.shape[0]) &gt; 0) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:         <span class="n">features</span><span class="p">[</span><span class="n">v1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="n">feature_offset</span><span class="p">:]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3.data = __pyx_v_pair.data;
    __pyx_t_3.memview = __pyx_v_pair.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_4 = -1;
    if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_3,
    __pyx_v_pair.shape[0], __pyx_v_pair.strides[0], __pyx_v_pair.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_4,
    __pyx_v_18quad_mesh_simplify_13contract_pair_feature_offset,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span>
}

__pyx_t_5.data = __pyx_v_features.data;
    __pyx_t_5.memview = __pyx_v_features.memview;
    __PYX_INC_MEMVIEW(&amp;__pyx_t_5, 1);
    {
    Py_ssize_t __pyx_tmp_idx = __pyx_v_v1;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_features.strides[0];
        if ((0)) <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span>
        __pyx_t_5.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_5.shape[0] = __pyx_v_features.shape[1];
__pyx_t_5.strides[0] = __pyx_v_features.strides[1];
    __pyx_t_5.suboffsets[0] = -1;

if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_3, __pyx_t_5, 1, 1, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span>
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
    __pyx_t_5.memview = NULL; __pyx_t_5.data = NULL;
    __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
    __pyx_t_3.memview = NULL; __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">116</span>: </pre>
</div></body></html>
